"use strict";(self.webpackChunkiconic_taste_backend=self.webpackChunkiconic_taste_backend||[]).push([[9497],{60762:(pe,C,t)=>{t.r(C),t.d(C,{default:()=>De});var e=t(67294),f=t(78384),p=t(68547),U=t(97132),V=t(80831),G=t(11700),z=t.n(G),b=t(23724),D=t(78718),B=t.n(D),N=t(15482),I=t(62031),L=t(49425),O=t(5493),A=t(78862),Q=t(19408),u=t(34626),E=t(9008),W=t(84686),S=t(43808),Y=t(91767),Z=t(55967),F=t(28649),M=t.n(F),$=t(48765),R=t.n($),J=t(84734),d=t.n(J),s=t(20088),i=t(32104),fe=t(57557),ge=t.n(fe),ee=t(63955),he=Object.defineProperty,ve=Object.defineProperties,Pe=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,ye=Object.prototype.hasOwnProperty,we=Object.prototype.propertyIsEnumerable,re=(a,n,r)=>n in a?he(a,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[n]=r,Ee=(a,n)=>{for(var r in n||(n={}))ye.call(n,r)&&re(a,r,n[r]);if(te)for(var r of te(n))we.call(n,r)&&re(a,r,n[r]);return a},Se=(a,n)=>ve(a,Pe(n)),ae=(a,n,r)=>new Promise((T,y)=>{var x=m=>{try{P(r.next(m))}catch(w){y(w)}},j=m=>{try{P(r.throw(m))}catch(w){y(w)}},P=m=>m.done?T(m.value):Promise.resolve(m.value).then(x,j);P((r=r.apply(a,n)).next())});const Oe=()=>ae(void 0,null,function*(){const{data:a}=yield ee.be.get("/admin/users/me");return a.data}),Me=a=>ae(void 0,null,function*(){const n=ge()(a,["confirmPassword","currentTheme"]),{data:r}=yield ee.be.put("/admin/users/me",n);return Se(Ee({},r.data),{currentTheme:a.currentTheme})});var be=t(53209),Ie=t(8278);const Le=be.object().shape(Ie.Rw);var ne=t(58836),Ae=Object.defineProperty,Te=Object.defineProperties,xe=Object.getOwnPropertyDescriptors,se=Object.getOwnPropertySymbols,je=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable,oe=(a,n,r)=>n in a?Ae(a,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[n]=r,le=(a,n)=>{for(var r in n||(n={}))je.call(n,r)&&oe(a,r,n[r]);if(se)for(var r of se(n))Ce.call(n,r)&&oe(a,r,n[r]);return a},ie=(a,n)=>Te(a,xe(n)),de=(a,n,r)=>new Promise((T,y)=>{var x=m=>{try{P(r.next(m))}catch(w){y(w)}},j=m=>{try{P(r.throw(m))}catch(w){y(w)}},P=m=>m.done?T(m.value):Promise.resolve(m.value).then(x,j);P((r=r.apply(a,n)).next())});const Ge=f.default.a`
  color: ${({theme:a})=>a.colors.primary600};
`,K=(0,f.default)(Z.TextInput)`
  ::-ms-reveal {
    display: none;
  }
`,X=(0,f.default)(Y.FieldAction)`
  svg {
    height: 1rem;
    width: 1rem;
    path {
      fill: ${({theme:a})=>a.colors.neutral600};
    }
  }
`,De=()=>{const[a,n]=(0,e.useState)(!1),[r,T]=(0,e.useState)(!1),[y,x]=(0,e.useState)(!1),{changeLocale:j,localeNames:P}=(0,s.Z)(),{setUserDisplayName:m}=(0,p.useAppInfos)(),w=(0,b.useQueryClient)(),{formatMessage:o}=(0,U.useIntl)(),{trackUsage:Be}=(0,p.useTracking)(),k=(0,p.useNotification)(),{lockApp:Ne,unlockApp:Fe}=(0,p.useOverlayBlocker)(),{notifyStatus:Re}=(0,W.useNotifyAT)(),{currentTheme:He,themes:ce,onChangeTheme:Ue}=(0,i.M1)();(0,p.useFocusWhenNavigate)();const{status:Ve,data:H}=(0,b.useQuery)("user",()=>Oe(),{onSuccess:()=>{Re(o({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError:()=>{k({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),ze=Ve!=="success",me=(0,b.useMutation)(l=>Me(l),{onSuccess:l=>de(void 0,null,function*(){yield w.invalidateQueries("user"),p.auth.setUserInfo(B()(l,["email","firstname","lastname","username","preferedLanguage"]));const g=l.username||(0,ne.Pp)(l.firstname,l.lastname);m(g),j(l.preferedLanguage),Ue(l.currentTheme),Be("didChangeMode",{newMode:l.currentTheme}),k({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})}),onSettled:()=>{Fe()},refetchActive:!0}),{isLoading:Qe}=me,We=(l,g)=>de(void 0,[l,g],function*(h,{setErrors:q}){Ne();const c=h.username||null;me.mutate(ie(le({},h),{username:c}),{onError:v=>{var ue;const _=(ue=v==null?void 0:v.response)==null?void 0:ue.data;return _!=null&&_.data?q(_.data):k({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})}),Ye=["currentTheme","email","firstname","lastname","username","preferedLanguage"],Ze=B()(ie(le({},H),{currentTheme:He}),Ye);if(ze)return e.createElement(I.Main,{"aria-busy":"true"},e.createElement(N.Helmet,{title:o({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(A.HeaderLayout,{title:o({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),e.createElement(A.ContentLayout,null,e.createElement(p.LoadingIndicatorPage,null)));const $e=Object.keys(ce).filter(l=>ce[l]);return e.createElement(I.Main,{"aria-busy":Qe},e.createElement(N.Helmet,{title:o({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(V.Formik,{onSubmit:We,initialValues:Ze,validateOnChange:!1,validationSchema:Le,enableReinitialize:!0},({errors:l,values:g,handleChange:h,isSubmitting:q})=>e.createElement(p.Form,null,e.createElement(A.HeaderLayout,{title:H.username||(0,ne.Pp)(H.firstname,H.lastname),primaryAction:e.createElement(Q.Button,{startIcon:e.createElement(d(),null),loading:q,type:"submit"},o({id:"global.save",defaultMessage:"Save"}))}),e.createElement(O.Box,{paddingBottom:10},e.createElement(A.ContentLayout,null,e.createElement(E.Stack,{spacing:6},e.createElement(O.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(E.Stack,{spacing:4},e.createElement(L.Typography,{variant:"delta",as:"h2"},o({id:"global.profile",defaultMessage:"Profile"})),e.createElement(u.Grid,{gap:5},e.createElement(u.GridItem,{s:12,col:6},e.createElement(p.GenericInput,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:l.firstname,onChange:h,value:g.firstname||"",type:"text",name:"firstname",required:!0})),e.createElement(u.GridItem,{s:12,col:6},e.createElement(p.GenericInput,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:l.lastname,onChange:h,value:g.lastname||"",type:"text",name:"lastname"})),e.createElement(u.GridItem,{s:12,col:6},e.createElement(p.GenericInput,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:l.email,onChange:h,value:g.email||"",type:"email",name:"email",required:!0})),e.createElement(u.GridItem,{s:12,col:6},e.createElement(p.GenericInput,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:l.username,onChange:h,value:g.username||"",type:"text",name:"username"}))))),e.createElement(O.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(E.Stack,{spacing:4},e.createElement(L.Typography,{variant:"delta",as:"h2"},o({id:"global.change-password",defaultMessage:"Change password"})),e.createElement(u.Grid,{gap:5},e.createElement(u.GridItem,{s:12,col:6},e.createElement(K,{error:l.currentPassword?o({id:l.currentPassword,defaultMessage:l.currentPassword}):"",onChange:h,value:g.currentPassword||"",label:o({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:y?"text":"password",endAction:e.createElement(X,{onClick:c=>{c.stopPropagation(),x(v=>!v)},label:o(y?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},y?e.createElement(M(),null):e.createElement(R(),null))}))),e.createElement(u.Grid,{gap:5},e.createElement(u.GridItem,{s:12,col:6},e.createElement(K,{error:l.password?o({id:l.password,defaultMessage:l.password}):"",onChange:h,value:g.password||"",label:o({id:"global.password",defaultMessage:"Password"}),name:"password",type:a?"text":"password",endAction:e.createElement(X,{onClick:c=>{c.stopPropagation(),n(v=>!v)},label:o(a?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},a?e.createElement(M(),null):e.createElement(R(),null))})),e.createElement(u.GridItem,{s:12,col:6},e.createElement(K,{error:l.confirmPassword?o({id:l.confirmPassword,defaultMessage:l.confirmPassword}):"",onChange:h,value:g.confirmPassword||"",label:o({id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"}),name:"confirmPassword",type:r?"text":"password",endAction:e.createElement(X,{onClick:c=>{c.stopPropagation(),T(v=>!v)},label:o(r?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},r?e.createElement(M(),null):e.createElement(R(),null))}))))),e.createElement(O.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(E.Stack,{spacing:4},e.createElement(E.Stack,{spacing:1},e.createElement(L.Typography,{variant:"delta",as:"h2"},o({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})),e.createElement(L.Typography,null,o({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:e.createElement(Ge,{target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales"},o({id:"Settings.profile.form.section.experience.documentation",defaultMessage:"here"}))}))),e.createElement(u.Grid,{gap:5},e.createElement(u.GridItem,{s:12,col:6},e.createElement(S.Select,{label:o({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:o({id:"global.select",defaultMessage:"Select"}),hint:o({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{h({target:{name:"preferedLanguage",value:null}})},clearLabel:o({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:g.preferedLanguage,onChange:c=>{h({target:{name:"preferedLanguage",value:c}})}},Object.keys(P).map(c=>{const v=P[c];return e.createElement(S.Option,{value:c,key:c},v)}))),e.createElement(u.GridItem,{s:12,col:6},e.createElement(S.Select,{label:o({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:o({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:o({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:g.currentTheme,onChange:c=>{h({target:{name:"currentTheme",value:c}})}},$e.map(c=>{const v=o({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:z()(c)});return e.createElement(S.Option,{value:c,key:c},v)}))))))))))))}},8278:(pe,C,t)=>{t.d(C,{YM:()=>J,Rw:()=>O});var e=t(53209),f=t(68547),p=Object.defineProperty,U=Object.defineProperties,V=Object.getOwnPropertyDescriptors,G=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,D=(d,s,i)=>s in d?p(d,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[s]=i,B=(d,s)=>{for(var i in s||(s={}))z.call(s,i)&&D(d,i,s[i]);if(G)for(var i of G(s))b.call(s,i)&&D(d,i,s[i]);return d},N=(d,s)=>U(d,V(s));const I={firstname:e.mixed().required(f.translatedErrors.required),lastname:e.mixed(),email:e.string().email(f.translatedErrors.email).lowercase().required(f.translatedErrors.required),username:e.string().nullable(),password:e.string().min(8,f.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.string().min(8,f.translatedErrors.minLength).oneOf([e.ref("password"),null],"components.Input.error.password.noMatch").when("password",(d,s)=>d?s.required(f.translatedErrors.required):s)},O=N(B({},I),{currentPassword:e.string().when(["password","confirmPassword"],(d,s,i)=>d||s?i.required(f.translatedErrors.required):i),preferedLanguage:e.string().nullable()}),Q={roles:e.array().min(1,f.translatedErrors.required).required(f.translatedErrors.required)};var u=Object.defineProperty,E=Object.defineProperties,W=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable,F=(d,s,i)=>s in d?u(d,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[s]=i,M=(d,s)=>{for(var i in s||(s={}))Y.call(s,i)&&F(d,i,s[i]);if(S)for(var i of S(s))Z.call(s,i)&&F(d,i,s[i]);return d},$=(d,s)=>E(d,W(s));const J=e.object().shape(M($(M({},I),{isActive:e.bool()}),Q))}}]);
