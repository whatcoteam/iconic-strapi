(self.webpackChunkiconic_taste_backend=self.webpackChunkiconic_taste_backend||[]).push([[1495],{78086:function(A,P,l){(function(e,f){A.exports=f(l(67294))})(this,function(e){return function(f){var v={};function n(t){if(v[t])return v[t].exports;var s=v[t]={i:t,l:!1,exports:{}};return f[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=f,n.c=v,n.d=function(t,s,u){n.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:u})},n.r=function(t){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,s){if(1&s&&(t=n(t)),8&s||4&s&&typeof t=="object"&&t&&t.__esModule)return t;var u=Object.create(null);if(n.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:t}),2&s&&typeof t!="string")for(var y in t)n.d(u,y,function(g){return t[g]}.bind(null,y));return u},n.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(s,"a",s),s},n.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},n.p="",n(n.s=67)}({0:function(f,v){f.exports=e},67:function(f,v,n){"use strict";n.r(v);var t=n(0);function s(){return(s=Object.assign||function(u){for(var y=1;y<arguments.length;y++){var g=arguments[y];for(var S in g)Object.prototype.hasOwnProperty.call(g,S)&&(u[S]=g[S])}return u}).apply(this,arguments)}v.default=function(u){return t.createElement("svg",s({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u),t.createElement("path",{d:"M0 2.8A.8.8 0 01.8 2h22.4a.8.8 0 01.8.8v2.71a1 1 0 01-1 1H1a1 1 0 01-1-1V2.8z",fill:"#32324D"}),t.createElement("path",{d:"M1.922 7.991C.197 6.675 0 6.252 0 5.289h23.953c.305 1.363-1.594 2.506-2.297 3.125-1.953 1.363-6.253 4.36-7.828 5.45-1.575 1.09-3.031.455-3.562 0-2.063-1.41-6.62-4.557-8.344-5.873zM22.8 18H1.2c-.663 0-1.2.471-1.2 1.053v1.894C0 21.529.537 22 1.2 22h21.6c.663 0 1.2-.471 1.2-1.053v-1.894c0-.582-.537-1.053-1.2-1.053z",fill:"#32324D"}),t.createElement("path",{d:"M0 9.555v10.972h24V9.554c-2.633 1.95-8.367 6.113-9.96 7.166-1.595 1.052-3.352.438-4.032 0L0 9.555z",fill:"#32324D"}))}}})})},4508:(A,P,l)=>{"use strict";l.r(P),l.d(P,{default:()=>se});var e=l(67294),f=l(97132),v=l(96486),n=l(68547),t=l(62031),s=l(78862),u=l(9008),y=l(5493),g=l(34626),S=l(49425),Z=l(55967),$=l(19408),w=l(84686),k=l(78086),U=l.n(k),W=l(45697),x=l.n(W),Y=l(78384),j=l(43808),r=l(26434);const J=Y.default.a`
  color: ${({theme:a})=>a.colors.primary600};
`,R=({config:a})=>{const{formatMessage:o}=(0,f.useIntl)();return e.createElement(u.Stack,{spacing:4},e.createElement(u.Stack,{spacing:1},e.createElement(S.Typography,{variant:"delta",as:"h2"},o({id:(0,r.Z)("Settings.email.plugin.title.config"),defaultMessage:"Configuration"})),e.createElement(S.Typography,null,o({id:(0,r.Z)("Settings.email.plugin.text.configuration"),defaultMessage:"The plugin is configured through the {file} file, checkout this {link} for the documentation."},{file:"./config/plugins.js",link:e.createElement(J,{href:"https://docs.strapi.io/developer-docs/latest/plugins/email.html",target:"_blank",rel:"noopener noreferrer"},"link")}))),e.createElement(g.Grid,{gap:5},e.createElement(g.GridItem,{col:6,s:12},e.createElement(Z.TextInput,{name:"shipper-email",label:o({id:(0,r.Z)("Settings.email.plugin.label.defaultFrom"),defaultMessage:"Default sender email"}),placeholder:o({id:(0,r.Z)("Settings.email.plugin.placeholder.defaultFrom"),defaultMessage:"ex: Strapi No-Reply <no-reply@strapi.io>"}),disabled:!0,onChange:()=>{},value:a.settings.defaultFrom})),e.createElement(g.GridItem,{col:6,s:12},e.createElement(Z.TextInput,{name:"response-email",label:o({id:(0,r.Z)("Settings.email.plugin.label.defaultReplyTo"),defaultMessage:"Default response email"}),placeholder:o({id:(0,r.Z)("Settings.email.plugin.placeholder.defaultReplyTo"),defaultMessage:"ex: Strapi <example@strapi.io>"}),disabled:!0,onChange:()=>{},value:a.settings.defaultReplyTo})),e.createElement(g.GridItem,{col:6,s:12},e.createElement(j.Select,{name:"email-provider",label:o({id:(0,r.Z)("Settings.email.plugin.label.provider"),defaultMessage:"Email provider"}),disabled:!0,onChange:()=>{},value:a.provider},e.createElement(j.Option,{value:a.provider},a.provider)))))};R.propTypes={config:x().shape({provider:x().string,settings:x().shape({defaultFrom:x().string,defaultReplyTo:x().string})}).isRequired};const K=R;var L=l(53209);const B=L.object().shape({email:L.string().email(n.translatedErrors.email).required(n.translatedErrors.required)});var Q=l(48763),X=l(9669),q=l.n(X),_=(a,o,d)=>new Promise((c,h)=>{var M=i=>{try{m(d.next(i))}catch(p){h(p)}},E=i=>{try{m(d.throw(i))}catch(p){h(p)}},m=i=>i.done?c(i.value):Promise.resolve(i.value).then(M,E);m((d=d.apply(a,o)).next())});const C=q().create({baseURL:""});C.interceptors.request.use(a=>_(void 0,null,function*(){return a.headers={Authorization:`Bearer ${n.auth.getToken()}`,Accept:"application/json","Content-Type":"application/json"},a}),a=>{Promise.reject(a)}),C.interceptors.response.use(a=>a,a=>{var o;throw((o=a.response)==null?void 0:o.status)===401&&(n.auth.clearAppStorage(),window.location.reload()),a});const O=C;var F=(a,o,d)=>new Promise((c,h)=>{var M=i=>{try{m(d.next(i))}catch(p){h(p)}},E=i=>{try{m(d.throw(i))}catch(p){h(p)}},m=i=>i.done?c(i.value):Promise.resolve(i.value).then(M,E);m((d=d.apply(a,o)).next())});const ee=()=>F(void 0,null,function*(){const{data:a}=yield O.get("/email/settings");return a.config}),te=a=>F(void 0,null,function*(){yield O.post("/email/test",a)}),G=()=>{const{formatMessage:a}=(0,f.useIntl)();return e.createElement(e.Fragment,null,e.createElement(n.SettingsPageTitle,{name:a({id:(0,r.Z)("Settings.email.plugin.title"),defaultMessage:"Configuration"})}),e.createElement(s.HeaderLayout,{id:"title",title:a({id:(0,r.Z)("Settings.email.plugin.title"),defaultMessage:"Configuration"}),subtitle:a({id:(0,r.Z)("Settings.email.plugin.subTitle"),defaultMessage:"Test the settings for the Email plugin"})}))};var ae=(a,o,d)=>new Promise((c,h)=>{var M=i=>{try{m(d.next(i))}catch(p){h(p)}},E=i=>{try{m(d.throw(i))}catch(p){h(p)}},m=i=>i.done?c(i.value):Promise.resolve(i.value).then(M,E);m((d=d.apply(a,o)).next())});const ne=()=>e.createElement(n.CheckPagePermissions,{permissions:Q.Z.settings},e.createElement(le,null)),le=()=>{var a,o;const d=(0,n.useNotification)(),{formatMessage:c}=(0,f.useIntl)(),{lockApp:h,unlockApp:M}=(0,n.useOverlayBlocker)(),{notifyStatus:E}=(0,w.useNotifyAT)();(0,n.useFocusWhenNavigate)();const[m,i]=(0,e.useState)({}),[p,D]=(0,e.useState)(!1),[H,z]=(0,e.useState)(!1),[b,N]=(0,e.useState)(""),[ie,V]=(0,e.useState)(!1),[re,oe]=(0,e.useState)({provider:"",settings:{defaultFrom:"",defaultReplyTo:"",testAddress:""}});(0,e.useEffect)(()=>{D(!0),ee().then(T=>{E(c({id:(0,r.Z)("Settings.email.plugin.notification.data.loaded"),defaultMessage:"Email settings data has been loaded"})),oe(T);const I=(0,v.get)(T,"settings.testAddress");I&&N(I)}).catch(()=>d({type:"warning",message:c({id:(0,r.Z)("Settings.email.plugin.notification.config.error"),defaultMessage:"Failed to retrieve the email config"})})).finally(()=>D(!1))},[c,d,E]),(0,e.useEffect)(()=>{m.email&&document.querySelector("#test-address-input").focus()},[m]),(0,e.useEffect)(()=>{B.validate({email:b},{abortEarly:!1}).then(()=>V(!0)).catch(()=>V(!1))},[b]);const de=T=>{N(()=>T.target.value)},ue=T=>ae(void 0,null,function*(){T.preventDefault();try{yield B.validate({email:b},{abortEarly:!1}),z(!0),h(),te({to:b}).then(()=>{d({type:"success",message:c({id:(0,r.Z)("Settings.email.plugin.notification.test.success"),defaultMessage:"Email test succeeded, check the {to} mailbox"},{to:b})})}).catch(()=>{d({type:"warning",message:c({id:(0,r.Z)("Settings.email.plugin.notification.test.error"),defaultMessage:"Failed to send a test mail to {to}"},{to:b})})}).finally(()=>{z(!1),M()})}catch(I){i((0,n.getYupInnerErrors)(I))}});return p?e.createElement(t.Main,{labelledBy:"title","aria-busy":"true"},e.createElement(G,null),e.createElement(s.ContentLayout,null,e.createElement(n.LoadingIndicatorPage,null))):e.createElement(t.Main,{labelledBy:"title","aria-busy":H},e.createElement(G,null),e.createElement(s.ContentLayout,null,e.createElement("form",{onSubmit:ue},e.createElement(u.Stack,{spacing:7},e.createElement(y.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(K,{config:re})),e.createElement(y.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(u.Stack,{spacing:4},e.createElement(S.Typography,{variant:"delta",as:"h2"},c({id:(0,r.Z)("Settings.email.plugin.title.test"),defaultMessage:"Test email delivery"})),e.createElement(g.Grid,{gap:5,alignItems:"end"},e.createElement(g.GridItem,{col:6,s:12},e.createElement(Z.TextInput,{id:"test-address-input",name:"test-address",onChange:de,label:c({id:(0,r.Z)("Settings.email.plugin.label.testAddress"),defaultMessage:"Recipient email"}),value:b,error:((a=m.email)==null?void 0:a.id)&&c({id:(0,r.Z)(`${(o=m.email)==null?void 0:o.id}`),defaultMessage:"This is an invalid email"}),placeholder:c({id:(0,r.Z)("Settings.email.plugin.placeholder.testAddress"),defaultMessage:"ex: developer@example.com"})})),e.createElement(g.GridItem,{col:7,s:12},e.createElement($.Button,{loading:H,disabled:!ie,type:"submit",startIcon:e.createElement(U(),null)},c({id:(0,r.Z)("Settings.email.plugin.button.test-email"),defaultMessage:"Send test email"}))))))))))},se=ne}}]);
